# **–°–∏—Å—Ç–µ–º–∞ –ü—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ê–Ω–∞–ª–∏–∑–∞ (Proctoring & Analysis System)**

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π proctoring-system ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–º –ø—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

1. **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ú–æ–¥—É–ª—å –ü—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥–∞:** –í—ã—Å–æ–∫–æ–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ JavaScript-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (117-test.html), –∫–æ—Ç–æ—Ä–æ–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞, –º—ã—à—å, —Ñ–æ–∫—É—Å, –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—á–∞—Ç–∏) –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PDF-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞.  
2. **–ë—ç–∫–µ–Ω–¥ (Flask API):** –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ API –Ω–∞ Flask, –æ—Ç–≤–µ—á–∞—é—â–µ–µ –∑–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.  
3. **–ê–¥–º–∏–Ω-–ü–∞–Ω–µ–ª—å (SPA):** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –æ–¥–Ω–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (results.html) –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π.

## **üöÄ –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**

–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å —É–ø–æ—Ä–æ–º –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ü—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ê–Ω–∞–ª–∏—Ç–∏–∫–∏**

* **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ü—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥:** –°–æ—á–µ—Ç–∞–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ ("–°–ª–µ–¥—è—â–∏–π –ì–ª–∞–∑" \#proctor-eye), –∞–∫—Ç–∏–≤–Ω—ã–µ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ PrintScreen —á–µ—Ä–µ–∑ \#flash-overlay) –∏ –ø–∞—Å—Å–∏–≤–Ω—ã–µ (—Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ keyboardDynamics) –º–µ—Ç–æ–¥—ã.  
* **–ì–ª—É–±–æ–∫–∏–π –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏–∑:** –í–∫–ª—é—á–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ "–∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–≥–æ –ø–æ—á–µ—Ä–∫–∞" (keyboardDynamics) –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –º—ã—à–∏ (mouseMovements) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ fastdtw.  
* **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ê–Ω–∞–ª–∏–∑ (–ö–ª–∏–µ–Ω—Ç/–°–µ—Ä–≤–µ—Ä):** –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –±—ã—Å—Ç—Ä—ã–π DTW-–∞–Ω–∞–ª–∏–∑ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (admin/analysis.js) –∏–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (/api/analyze\_mouse).  
* **–ê–Ω–∞–ª–∏–∑ –û—Ç–ø–µ—á–∞—Ç–∫–æ–≤ (Fingerprint):** –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ privacySafeHash (–æ—Ç–ø–µ—á–∞—Ç–∫—É –±—Ä–∞—É–∑–µ—Ä–∞) –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞).  
* **–ñ—É—Ä–Ω–∞–ª –°–æ–±—ã—Ç–∏–π:** –î–µ—Ç–∞–ª—å–Ω—ã–π —Ç–∞–π–º–ª–∞–π–Ω –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç study\_started –¥–æ focus\_loss –∏ test\_finished).

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

* **–ì–∏–±—Ä–∏–¥–Ω–∞—è –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Flask-Login (–≤–µ–±-—Å–µ—Å—Å–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤) –∏ API-–∫–ª—é—á–∏ (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞). –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @admin\_required —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±–∞ —Å–ª—É—á–∞—è.  
* **"–£–º–Ω—ã–µ" API-–∫–ª—é—á–∏:** –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @api\_key\_required –∫—ç—à–∏—Ä—É–µ—Ç –∫–ª—é—á–∏ –≤ Redis, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (scopes) –∏ –≤–µ–¥–µ—Ç –∞—É–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (usage\_count).  
* **CSRF-–ó–∞—â–∏—Ç–∞ SPA:** –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (Flask meta-tag \-\> api.js —Å—á–∏—Ç—ã–≤–∞–µ—Ç \-\> X-CSRFToken –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–æ –≤—Å–µ—Ö fetch-–∑–∞–ø—Ä–æ—Å–∞—Ö).  
* **XSS-–ó–∞—â–∏—Ç–∞:** ui.js –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç escapeHtml –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö.  
* **–í–∞–ª–∏–¥–∞—Ü–∏—è –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∞ API:** Pydantic (result\_schema.py) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é JSON-payload, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**

* **Real-time –≤ –ö–ª–∞—Å—Ç–µ—Ä–µ:** –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Redis Pub/Sub** –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è SocketIO. –í–æ—Ä–∫–µ—Ä—ã Flask –Ω–µ –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –Ω–∞–ø—Ä—è–º—É—é, –∞ –ø—É–±–ª–∏–∫—É—é—Ç —Å–æ–±—ã—Ç–∏—è –≤ Redis, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–æ—Ä–∫–µ—Ä—ã.  
* **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –î–∞–Ω–Ω—ã—Ö:** INSERT ... ON CONFLICT (get\_or\_create\_user) –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  
* **–ó–∞—â–∏—Ç–∞ –æ—Ç "–ì–æ–Ω–∫–∏ –°–æ—Å—Ç–æ—è–Ω–∏–π":** document.py –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É PostgreSQL (with\_for\_update()) –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–º–µ—Ä–æ–≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è –∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö.  
* **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Observability):** –°–∏—Å—Ç–µ–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ **Prometheus** (–Ω–∞–ø—Ä–∏–º–µ—Ä, TESTS\_COMPLETED\_TOTAL) –∏ –≤–µ–¥–µ—Ç **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ JSON-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å request\_id –¥–ª—è —Å–∫–≤–æ–∑–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –≤ ELK/Splunk.

## **üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ü–æ—Ç–æ–∫ –î–∞–Ω–Ω—ã—Ö**

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **Backend for Frontend (BFF)**. web/routes.py –æ—Ç–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ "–æ–±–æ–ª–æ—á–∫–∏" (SPA-—Ö–æ—Å—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —É api/routes.py.

## **üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –†–æ–ª—å |
| :---- | :---- | :---- |
| **–ë—ç–∫–µ–Ω–¥** | Python (Flask) | –Ø–¥—Ä–æ API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –ø–∞—Ç—Ç–µ—Ä–Ω "–§–∞–±—Ä–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π". |
|  | PostgreSQL | –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. |
|  | Redis | –ö–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è 4-—Ö –∑–∞–¥–∞—á: –ö—ç—à API-–∫–ª—é—á–µ–π, –ö—ç—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, Rate-Limiter, –û—á–µ—Ä–µ–¥—å (Pub/Sub) –¥–ª—è SocketIO. |
|  | Pydantic | –í–∞–ª–∏–¥–∞—Ü–∏—è "–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞" API (JSON payload –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞). |
|  | fastdtw | –ê–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –º—ã—à–∏. |
| **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (–ê–¥–º–∏–Ω)** | Vanilla JS (SPA) | –ú–æ–¥—É–ª—å–Ω–∞—è SPA-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (state.js, api.js, ui.js, analysis.js). |
|  | Chart.js | –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤. |
|  | Tailwind CSS | –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è SPA-–ø–∞–Ω–µ–ª–∏. |
| **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)** | Vanilla JS | –õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥, —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫. |
|  | jsPDF, html2canvas | *–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è* –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤. |
| **DevOps** | Docker / Docker Compose | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–æ–≤–∫–∞ 4-—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (app, nginx, postgres, redis). |
|  | Nginx | Reverse-proxy, —Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ SSL, —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ –∏–∑ static\_data volume. |
|  | Certbot | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt. |
|  | Prometheus | –°–±–æ—Ä –∏ —ç–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. |

## **‚öôÔ∏è –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**

–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º "—É–º–Ω–æ–≥–æ" —Å–∫—Ä–∏–ø—Ç–∞-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ deploy.sh.

### **1\. "–£–º–Ω–æ–µ" –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (deploy.sh)**

–≠—Ç–æ —Å–∫—Ä–∏–ø—Ç **"–Ω—É–ª–µ–≤–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"**. –û–Ω –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç "–≥–æ–ª—ã–π" —Å–µ—Ä–≤–µ—Ä —Å Docker –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á—É—é —Å–∏—Å—Ç–µ–º—É.

**–ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –°–∏—Å—Ç–µ–º—ã:** –£–±–µ–∂–¥–∞–µ—Ç—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ docker, sudo, curl –∏ —Ç.–¥. (–º–æ–∂–µ—Ç —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker).  
2. **–°–±–æ—Ä –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** –ó–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (--start) –∏–ª–∏ —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (--non-interactive –¥–ª—è CI/CD).  
3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è:** –°–æ–∑–¥–∞–µ—Ç –Ω–∞ –ª–µ—Ç—É –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏:  
   * prod.env (—Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –∏ –ø–∞—Ä–æ–ª—è–º–∏).  
   * docker-compose.yml (–æ–ø–∏—Å—ã–≤–∞–µ—Ç 4 —Å–µ—Ä–≤–∏—Å–∞: app, nginx, postgres, redis).  
   * nginx/nginx.conf (—Å –≤–∞—à–∏–º SERVER\_NAME).  
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è SSL:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç *–∏–ª–∏* (—Å —Ñ–ª–∞–≥–æ–º \--use-letsencrypt) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –±–æ–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç **Certbot**.  
5. **–ó–∞–ø—É—Å–∫ –°–µ—Ä–≤–∏—Å–æ–≤:** –í—ã–ø–æ–ª–Ω—è–µ—Ç docker compose up \-d.  
6. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** –í—ã–ø–æ–ª–Ω—è–µ—Ç docker compose exec –¥–ª—è:  
   * flask db upgrade (–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î).  
   * flask create-admin (–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞).  
   * flask create-apikey (–ì–µ–Ω–µ—Ä–∞—Ü–∏—è API\_KEY\_FRONTEND\_CLIENT –∏ **–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–≥–æ –≤ .env**).  
   * flask collect (–°–±–æ—Ä —Å—Ç–∞—Ç–∏–∫–∏ –¥–ª—è Nginx).  
7. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è "–ü–∞–Ω–µ–ª–∏ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è":** –°–æ–∑–¥–∞–µ—Ç Makefile –∏ .sh —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

### **2\. "–ü–∞–Ω–µ–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è" (Makefile)**

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Makefile —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∞—à–∏–º –æ—Å–Ω–æ–≤–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :---- | :---- |
| make up | –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. |
| make down | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã. |
| make restart | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã. |
| make status | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. |
| make logs / make logs-app | –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ª–æ–≥–∏ (–≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–ª–∏ —Ç–æ–ª—å–∫–æ app). |
| make update | **–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** —Å–∫–∞—á–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏. |
| make backup | **–°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø:** –¥–µ–ª–∞–µ—Ç pg\_dump –±–∞–∑—ã –∏ tar-–∞—Ä—Ö–∏–≤ –∫–æ–Ω—Ñ–∏–≥–æ–≤. |
| make restore | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞. |
| make migrate | –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –≤—Ä—É—á–Ω—É—é. |
| make shell | –û—Ç–∫—Ä—ã—Ç—å bash –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ app. |
| make shell-db | –û—Ç–∫—Ä—ã—Ç—å psql (SQL-–∫–æ–Ω—Å–æ–ª—å) –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ postgres. |
| make shell-redis | –û—Ç–∫—Ä—ã—Ç—å redis-cli (–∫–æ–Ω—Å–æ–ª—å Redis). |
| make monitor | –ó–∞–ø—É—Å—Ç–∏—Ç—å TUI-–¥–∞—à–±–æ—Ä–¥ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ CPU/RAM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. |
| make create-apikey | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ API-–∫–ª—é—á–∞. |
| make destroy | **(–û–ü–ê–°–ù–û)** –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, volumes). |

–î–∏–∞–≥—Ä–∞–º–º–∞ –Ω–∏–∂–µ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∞: –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

sequenceDiagram  
    actor User as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ë—Ä–∞—É–∑–µ—Ä)  
    participant Web as –í–µ–±-—Å–µ—Ä–≤–µ—Ä (web/routes.py)  
    participant API as API-—Å–µ—Ä–≤–µ—Ä (api/routes.py)  
    participant Auth as –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã (@api\_key\_required)  
    participant Cache as Redis (–ö—ç—à)  
    participant DB as –ë–î (SQLAlchemy)  
    participant Socket as –°–µ—Ä–≤–µ—Ä SocketIO  
    participant PubSub as Redis (Pub/Sub)  
    actor Admin as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–ë—Ä–∞—É–∑–µ—Ä)

    %% \--- –§–∞–∑–∞ 0: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è (–ó–∞—Ä–∞–Ω–µ–µ) \---  
    Admin-\>\>+Socket: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ WebSocket  
    Socket--\>\>-Admin: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ  
    Note right of Admin: –ê–¥–º–∏–Ω –æ–∂–∏–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–π

    %% \--- –§–∞–∑–∞ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Ç–µ—Å—Ç \---  
    User-\>\>+Web: GET /117test  
    Web--\>\>-User: HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ (117-test.html)  
      
    group –§–∞–∑–∞ 1: log\_event('test\_started')  
        User-\>\>+API: POST /api/log\_event (eventType: 'test\_started', X-API-Key: ...)  
          
        %% \--- –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–∞ \---  
        API-\>\>+Auth: @api\_key\_required  
        Auth-\>\>+Cache: cache.get(api\_key) ?  
        Cache--\>\>-Auth: (miss)  
        Auth-\>\>+DB: ApiKey.query(key) ?  
        DB--\>\>-Auth: key\_obj  
        Auth-\>\>+Cache: cache.set(key\_obj)  
        Auth-\>\>+DB: UPDATE ApiKey SET usage\_count...  
        Auth--\>\>-API: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω  
          
        %% \--- –õ–æ–≥–∏–∫–∞ 'log\_event' \---  
        API-\>\>+DB: db.session.get(ResultMetadata, session\_id) ?  
        DB--\>\>-API: None (–°–µ—Å—Å–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)  
        API-\>\>DB: INSERT ResultMetadata (session\_id, test\_type="pending")  
        API-\>\>DB: INSERT ProctoringEvent (eventType='test\_started')  
        API-\>\>DB: db.session.commit()  
        API--\>\>-User: 200 OK  
    end

    loop –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç  
        User-\>\>API: POST /api/log\_event (eventType: 'focus\_loss', ...)  
        API-\>\>User: 200 OK  
    end

    %% \--- –§–∞–∑–∞ 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ—Å—Ç \---  
    group –§–∞–∑–∞ 2: save\_results  
        User-\>\>+API: POST /api/save\_results (JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, X-API-Key: ...)  
          
        %% \--- –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–∞ (—Ç–µ–ø–µ—Ä—å –∏–∑ –∫—ç—à–∞) \---  
        API-\>\>+Auth: @api\_key\_required  
        Auth-\>\>+Cache: cache.get(api\_key) ?  
        Cache--\>\>-Auth: key\_obj (hit)  
        Auth-\>\>+DB: UPDATE ApiKey SET usage\_count...  
        Auth--\>\>-API: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω

        %% \--- –õ–æ–≥–∏–∫–∞ 'save\_results' (–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è) \---  
        Note over API,DB: –ù–∞—á–∞–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏  
        API-\>\>API: –í–∞–ª–∏–¥–∞—Ü–∏—è JSON (SaveResultsRequest)  
        API-\>\>DB: get\_or\_create\_user() (INSERT... ON CONFLICT...)  
        DB--\>\>API: user\_obj  
        API-\>\>DB: db.session.get(ResultMetadata, session\_id)  
        DB--\>\>-API: 'pending' result\_obj  
        API-\>\>API: result.score \= 95, result.raw\_data \= {...}

        alt –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω (score \>= 80\)  
            API-\>\>DB: –í—ã–∑–æ–≤ generate\_document\_number()  
            Note right of DB: Pessimistic Lock: \\n SELECT... FOR UPDATE  
            DB-\>\>DB: UPDATE DocumentCounter SET last\_sequence\_number \+= 1  
            DB--\>\>API: doc\_number (e.g., "25/11-0001")  
            API-\>\>DB: INSERT Certificate (...)  
        end  
          
        API-\>\>DB: db.session.commit()  
        Note over API,DB: –§–∏–∫—Å–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏  
        DB--\>\>API: Commit OK

        %% \--- –§–∞–∑–∞ 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–ø–æ—Å–ª–µ Commit) \---  
        group –§–∞–∑–∞ 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  
            API-\>\>Cache: cache.delete\_memoized(get\_results\_api)  
            API-\>\>Socket: socketio.emit("update\_needed", ...)  
            Note right of Socket: ...–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Pub/Sub  
            Socket-\>\>+PubSub: PUBLISH "updates"  
            PubSub--\>\>+Socket: (–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ –≤—Å–µ–º–∏ –≤–æ—Ä–∫–µ—Ä–∞–º–∏)  
            Socket-\>\>Admin: emit("update\_needed") (WebSocket push)  
        end  
          
        API-\>\>API: METRICS.TESTS\_COMPLETED\_TOTAL.inc()  
        API--\>\>-User: 201 Created ({"officialDocumentNumber": "25/11-0001"})  
    end



## **üìú –õ–∏—Ü–µ–Ω–∑–∏—è**

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. –≤ —Ñ–∞–π–ª–µ LICENSE.
